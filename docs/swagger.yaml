basePath: /api/v1
definitions:
  ErrorResponse:
    properties:
      error:
        example: invalid_request
        type: string
      message:
        example: The request was invalid
        type: string
      status:
        example: 400
        type: integer
    type: object
  ForgotPasswordRequest:
    properties:
      email:
        example: user@example.com
        type: string
    required:
    - email
    type: object
  RefreshTokenRequest:
    properties:
      refresh_token:
        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        type: string
    required:
    - refresh_token
    type: object
  ResendVerificationRequest:
    properties:
      email:
        example: user@example.com
        type: string
    required:
    - email
    type: object
  ResetPasswordRequest:
    properties:
      new_password:
        example: newPassword123
        minLength: 8
        type: string
      token:
        example: reset_token_here
        type: string
    required:
    - new_password
    - token
    type: object
  SuccessResponse:
    properties:
      data: {}
      message:
        example: Operation completed successfully
        type: string
      status:
        example: 200
        type: integer
    type: object
  VerifyEmailRequest:
    properties:
      token:
        example: verification_token_here
        type: string
    required:
    - token
    type: object
  handlers.CreateAdminRequest:
    properties:
      display_name:
        type: string
      email:
        type: string
      organization_id:
        type: string
      password:
        minLength: 8
        type: string
      username:
        maxLength: 50
        minLength: 3
        type: string
    required:
    - display_name
    - email
    - password
    - username
    type: object
  handlers.LoginRequest:
    properties:
      email:
        type: string
      password:
        minLength: 6
        type: string
    required:
    - email
    - password
    type: object
  handlers.LoginResponse:
    properties:
      access_token:
        type: string
      expires_in:
        type: integer
      refresh_token:
        type: string
      token_type:
        type: string
      user:
        $ref: '#/definitions/models.User'
    type: object
  handlers.RegisterRequest:
    properties:
      display_name:
        type: string
      email:
        type: string
      organization_id:
        type: string
      password:
        minLength: 8
        type: string
      username:
        maxLength: 50
        minLength: 3
        type: string
    required:
    - display_name
    - email
    - organization_id
    - password
    - username
    type: object
  handlers.updateSettingsRequest:
    properties:
      settings:
        type: string
    type: object
  models.APIKey:
    properties:
      allowed_ip_ranges:
        items:
          type: string
        type: array
      created_at:
        type: string
      created_by:
        type: string
      expires_at:
        type: string
      id:
        type: string
      key_id:
        type: string
      last_used_at:
        type: string
      name:
        type: string
      organization_id:
        type: string
      rate_limit_per_hour:
        type: integer
      scopes:
        items:
          type: string
        type: array
      service_account_id:
        type: string
      status:
        type: string
      usage_count:
        type: integer
    type: object
  models.AccessReview:
    properties:
      completed_at:
        type: string
      created_at:
        type: string
      description:
        type: string
      due_date:
        type: string
      findings:
        description: JSONB as string
        type: string
      id:
        type: string
      name:
        type: string
      organization_id:
        type: string
      recommendations:
        description: JSONB as string
        type: string
      reviewer_id:
        type: string
      scope:
        description: JSONB as string
        type: string
      status:
        type: string
      updated_at:
        type: string
    type: object
  models.AuditEvent:
    properties:
      action:
        type: string
      additional_context:
        description: JSONB as string
        type: string
      error_message:
        type: string
      event_id:
        type: string
      id:
        type: string
      ip_address:
        type: string
      organization_id:
        type: string
      principal_id:
        type: string
      principal_type:
        type: string
      request_id:
        type: string
      resource_arn:
        type: string
      resource_id:
        type: string
      resource_type:
        type: string
      result:
        type: string
      session_id:
        type: string
      severity:
        type: string
      timestamp:
        type: string
      user_agent:
        type: string
    type: object
  models.BackupCodesResponse:
    properties:
      backup_codes:
        items:
          type: string
        type: array
      message:
        type: string
    type: object
  models.DisableMFARequest:
    properties:
      code:
        maxLength: 8
        minLength: 6
        type: string
      password:
        type: string
    required:
    - code
    - password
    type: object
  models.GlobalSettings:
    properties:
      allow_registration:
        type: boolean
      audit_log_retention_days:
        type: integer
      created_at:
        type: string
      email_verification_required:
        type: boolean
      id:
        type: string
      maintenance_message:
        type: string
      maintenance_mode:
        type: boolean
      max_session_duration:
        description: in minutes
        type: integer
      max_users_per_organization:
        type: integer
      password_min_length:
        type: integer
      require_mfa:
        type: boolean
      settings:
        description: JSONB for additional flexible settings
        type: string
      token_expiration_minutes:
        type: integer
      updated_at:
        type: string
    type: object
  models.Group:
    properties:
      attributes:
        description: JSONB as string
        type: string
      created_at:
        type: string
      deleted_at:
        type: string
      description:
        type: string
      group_type:
        type: string
      id:
        type: string
      max_members:
        type: integer
      name:
        type: string
      organization_id:
        type: string
      parent_group_id:
        type: string
      status:
        type: string
      updated_at:
        type: string
    type: object
  models.GroupMembership:
    properties:
      added_by:
        type: string
      expires_at:
        type: string
      group_id:
        type: string
      id:
        type: string
      joined_at:
        type: string
      principal_id:
        type: string
      principal_type:
        type: string
      role_in_group:
        type: string
    type: object
  models.MessageResponse:
    properties:
      message:
        type: string
    type: object
  models.Organization:
    properties:
      billing_tier:
        type: string
      created_at:
        type: string
      deleted_at:
        type: string
      description:
        type: string
      id:
        type: string
      max_resources:
        type: integer
      max_users:
        type: integer
      metadata:
        description: JSONB as string
        type: string
      name:
        type: string
      parent_id:
        type: string
      settings:
        description: JSONB as string
        type: string
      slug:
        type: string
      status:
        type: string
      updated_at:
        type: string
    type: object
  models.Policy:
    properties:
      approved_at:
        type: string
      approved_by:
        type: string
      created_at:
        type: string
      created_by:
        type: string
      deleted_at:
        type: string
      description:
        type: string
      document:
        description: JSONB as string
        type: string
      effect:
        type: string
      id:
        type: string
      is_system_policy:
        type: boolean
      name:
        type: string
      organization_id:
        type: string
      policy_type:
        type: string
      status:
        type: string
      updated_at:
        type: string
      version:
        type: string
    type: object
  models.Resource:
    properties:
      access_level:
        type: string
      accessed_at:
        type: string
      arn:
        type: string
      attributes:
        description: JSONB as string
        type: string
      checksum:
        type: string
      content_type:
        type: string
      created_at:
        type: string
      deleted_at:
        type: string
      description:
        type: string
      encryption_key_id:
        type: string
      id:
        type: string
      lifecycle_policy:
        description: JSONB as string
        type: string
      name:
        type: string
      organization_id:
        type: string
      owner_id:
        type: string
      owner_type:
        type: string
      parent_resource_id:
        type: string
      size_bytes:
        type: integer
      status:
        type: string
      tags:
        description: JSONB as string
        type: string
      type:
        type: string
      updated_at:
        type: string
      version:
        type: string
    type: object
  models.Role:
    properties:
      assume_role_policy:
        description: JSONB as string
        type: string
      created_at:
        type: string
      deleted_at:
        type: string
      description:
        type: string
      id:
        type: string
      is_system_role:
        type: boolean
      max_session_duration:
        type: string
      name:
        type: string
      organization_id:
        type: string
      path:
        type: string
      permissions_boundary:
        type: string
      role_type:
        type: string
      status:
        type: string
      tags:
        description: JSONB as string
        type: string
      trust_policy:
        description: JSONB as string
        type: string
      updated_at:
        type: string
    type: object
  models.ServiceAccount:
    properties:
      allowed_ip_ranges:
        items:
          type: string
        type: array
      attributes:
        description: JSONB as string
        type: string
      created_at:
        type: string
      deleted_at:
        type: string
      description:
        type: string
      id:
        type: string
      key_rotation_policy:
        description: JSONB as string
        type: string
      last_key_rotation:
        type: string
      max_token_lifetime:
        type: string
      name:
        type: string
      organization_id:
        type: string
      status:
        type: string
      updated_at:
        type: string
    type: object
  models.Session:
    properties:
      assumed_role_id:
        type: string
      context:
        description: JSONB as string
        type: string
      device_fingerprint:
        type: string
      expires_at:
        type: string
      id:
        type: string
      ip_address:
        type: string
      issued_at:
        type: string
      last_used_at:
        type: string
      location:
        description: JSONB as string
        type: string
      mfa_methods_used:
        items:
          type: string
        type: array
      mfa_verified:
        type: boolean
      organization_id:
        type: string
      permissions:
        description: JSONB as string
        type: string
      principal_id:
        type: string
      principal_type:
        type: string
      session_token:
        type: string
      status:
        type: string
      user_agent:
        type: string
    type: object
  models.SetupMFARequest:
    properties:
      method:
        enum:
        - totp
        - sms
        - email
        type: string
      phone:
        type: string
    required:
    - method
    type: object
  models.SetupMFAResponse:
    properties:
      backup_codes:
        items:
          type: string
        type: array
      message:
        type: string
      qr_code:
        type: string
      secret:
        type: string
    type: object
  models.User:
    properties:
      attributes:
        description: JSONB as string
        type: string
      avatar_url:
        type: string
      created_at:
        type: string
      deleted_at:
        type: string
      display_name:
        type: string
      email:
        type: string
      email_verified:
        type: boolean
      failed_login_attempts:
        type: integer
      id:
        type: string
      last_login:
        type: string
      locked_until:
        type: string
      mfa_enabled:
        type: boolean
      mfa_methods:
        items:
          type: string
        type: array
      organization_id:
        type: string
      password_changed_at:
        type: string
      preferences:
        description: JSONB as string
        type: string
      status:
        type: string
      updated_at:
        type: string
      username:
        type: string
    type: object
  models.VerifyMFARequest:
    properties:
      code:
        maxLength: 8
        minLength: 6
        type: string
      method:
        enum:
        - totp
        - sms
        - email
        - backup
        type: string
      remember_me:
        type: boolean
      user_id:
        type: string
    required:
    - code
    - method
    - user_id
    type: object
  queries.AccessReportData:
    properties:
      generated_at:
        type: string
      period:
        properties:
          end_time:
            type: string
          start_time:
            type: string
        type: object
      summary:
        properties:
          active_users:
            type: integer
          failed_logins:
            type: integer
          successful_logins:
            type: integer
          top_actions:
            items:
              $ref: '#/definitions/queries.ActionCount'
            type: array
          top_resources:
            items:
              $ref: '#/definitions/queries.ResourceAccessCount'
            type: array
          total_actions:
            type: integer
          total_sessions:
            type: integer
          total_users:
            type: integer
        type: object
      user_activity:
        items:
          $ref: '#/definitions/queries.UserActivitySummary'
        type: array
    type: object
  queries.ActionCount:
    properties:
      action:
        type: string
      count:
        type: integer
    type: object
  queries.ComplianceReportData:
    properties:
      generated_at:
        type: string
      period:
        properties:
          end_time:
            type: string
          start_time:
            type: string
        type: object
      policy_checks:
        items:
          $ref: '#/definitions/queries.PolicyCheckResult'
        type: array
      recommendations:
        items:
          type: string
        type: array
      security_events:
        items:
          $ref: '#/definitions/queries.SecurityEventSummary'
        type: array
      summary:
        properties:
          access_violations:
            type: integer
          compliance_score:
            type: number
          critical_violations:
            type: integer
          failed_checks:
            type: integer
          high_risk_events:
            type: integer
          passed_checks:
            type: integer
          policy_violations:
            type: integer
          total_checks:
            type: integer
          violations_by_category:
            additionalProperties:
              type: integer
            type: object
        type: object
    type: object
  queries.EffectivePermission:
    properties:
      actions:
        items:
          type: string
        type: array
      conditions:
        items:
          type: string
        type: array
      effect:
        type: string
      resource:
        type: string
      source:
        description: policy name or role
        type: string
    type: object
  queries.EffectivePermissions:
    properties:
      generated_at:
        type: string
      permissions:
        items:
          $ref: '#/definitions/queries.EffectivePermission'
        type: array
      principal_id:
        type: string
      principal_type:
        type: string
    type: object
  queries.PermissionCheckRequest:
    properties:
      action:
        type: string
      context:
        $ref: '#/definitions/queries.PolicyEvaluationContext'
      principal_id:
        type: string
      principal_type:
        type: string
      resource:
        type: string
    type: object
  queries.PermissionCheckResult:
    properties:
      allowed:
        type: boolean
      decision:
        type: string
      evaluation:
        $ref: '#/definitions/queries.PolicyEvaluationResult'
      policies:
        items:
          type: string
        type: array
      request:
        $ref: '#/definitions/queries.PermissionCheckRequest'
    type: object
  queries.PolicyCheckResult:
    properties:
      details:
        type: string
      policy_name:
        type: string
      status:
        type: string
    type: object
  queries.PolicyDetailedUsage:
    properties:
      allows:
        type: integer
      avg_response_ms:
        type: number
      denies:
        type: integer
      evaluations:
        type: integer
      last_used:
        type: string
      policy_id:
        type: string
      policy_name:
        type: string
      status:
        type: string
      version:
        type: string
    type: object
  queries.PolicyEvaluationContext:
    properties:
      action:
        type: string
      environment:
        additionalProperties:
          type: string
        type: object
      principal:
        type: string
      request_time:
        type: string
      resource:
        type: string
      session_id:
        type: string
      source_ip:
        type: string
      user_agent:
        type: string
    type: object
  queries.PolicyEvaluationResult:
    properties:
      conditions:
        additionalProperties:
          type: boolean
        type: object
      decision:
        description: final decision after combining policies
        type: string
      effect:
        description: allow, deny, not_applicable
        type: string
      matched_policy:
        type: string
      metadata:
        additionalProperties:
          type: string
        type: object
      reasons:
        items:
          type: string
        type: array
    type: object
  queries.PolicySimulationRequest:
    properties:
      context:
        $ref: '#/definitions/queries.PolicyEvaluationContext'
      policy_document:
        type: string
      test_cases:
        items:
          $ref: '#/definitions/queries.PolicySimulationTestCase'
        type: array
    type: object
  queries.PolicySimulationResult:
    properties:
      errors:
        items:
          type: string
        type: array
      evaluation:
        $ref: '#/definitions/queries.PolicyEvaluationResult'
      policy_id:
        type: string
      test_results:
        items:
          $ref: '#/definitions/queries.PolicyTestResult'
        type: array
      valid:
        type: boolean
    type: object
  queries.PolicySimulationTestCase:
    properties:
      action:
        type: string
      context:
        $ref: '#/definitions/queries.PolicyEvaluationContext'
      expected:
        description: allow, deny, not_applicable
        type: string
      name:
        type: string
      principal:
        type: string
      resource:
        type: string
    type: object
  queries.PolicyTestResult:
    properties:
      message:
        type: string
      passed:
        type: boolean
      result:
        $ref: '#/definitions/queries.PolicyEvaluationResult'
      test_case:
        $ref: '#/definitions/queries.PolicySimulationTestCase'
    type: object
  queries.PolicyUsageItem:
    properties:
      allow_count:
        type: integer
      deny_count:
        type: integer
      effectiveness_rate:
        type: number
      policy_id:
        type: string
      policy_name:
        type: string
      usage_count:
        type: integer
    type: object
  queries.PolicyUsageReportData:
    properties:
      generated_at:
        type: string
      period:
        properties:
          end_time:
            type: string
          start_time:
            type: string
        type: object
      policy_details:
        items:
          $ref: '#/definitions/queries.PolicyDetailedUsage'
        type: array
      summary:
        properties:
          active_policies:
            type: integer
          allow_decisions:
            type: integer
          deny_decisions:
            type: integer
          policy_evaluations:
            type: integer
          top_policies:
            items:
              $ref: '#/definitions/queries.PolicyUsageItem'
            type: array
          total_policies:
            type: integer
        type: object
    type: object
  queries.PolicyVersion:
    properties:
      created_at:
        type: string
      created_by:
        type: string
      document:
        type: string
      id:
        type: string
      policy_id:
        type: string
      status:
        description: draft, active, deprecated
        type: string
      version:
        type: string
    type: object
  queries.ResourceAccessCount:
    properties:
      count:
        type: integer
      resource_type:
        type: string
    type: object
  queries.SecurityEventSummary:
    properties:
      count:
        type: integer
      last_occurred:
        type: string
      severity:
        type: string
      type:
        type: string
    type: object
  queries.UserActivitySummary:
    properties:
      action_count:
        type: integer
      last_activity:
        type: string
      session_count:
        type: integer
      top_actions:
        items:
          type: string
        type: array
      user_email:
        type: string
      user_id:
        type: string
    type: object
host: localhost:8080
info:
  contact:
    email: support@themonkeys.com
    name: The Monkeys Team
    url: https://github.com/the-monkeys
  description: A comprehensive IAM system providing authentication, authorization,
    and access control for multi-tenant organizations with policy-based security,
    session management, and comprehensive audit trails.
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  termsOfService: https://themonkeys.com/terms
  title: Monkeys Identity & Access Management API
  version: "1.0"
paths:
  /access-reviews:
    get:
      consumes:
      - application/json
      description: Retrieve access reviews with filtering options
      parameters:
      - description: Organization ID
        in: query
        name: organization_id
        type: string
      - description: Reviewer ID
        in: query
        name: reviewer_id
        type: string
      - description: Review status
        in: query
        name: status
        type: string
      - description: Start time (RFC3339)
        in: query
        name: start_time
        type: string
      - description: End time (RFC3339)
        in: query
        name: end_time
        type: string
      - description: 'Limit (default: 50, max: 100)'
        in: query
        name: limit
        type: integer
      - description: 'Offset (default: 0)'
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Access reviews retrieved successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request parameters
          schema:
            $ref: '#/definitions/ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: List access reviews
      tags:
      - Access Reviews
    post:
      consumes:
      - application/json
      description: Create a new access review for periodic permission audits
      parameters:
      - description: Access review data
        in: body
        name: review
        required: true
        schema:
          $ref: '#/definitions/models.AccessReview'
      produces:
      - application/json
      responses:
        "201":
          description: Access review created successfully
          schema:
            $ref: '#/definitions/models.AccessReview'
        "400":
          description: Invalid request data
          schema:
            $ref: '#/definitions/ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Create access review
      tags:
      - Access Reviews
  /access-reviews/{id}:
    get:
      consumes:
      - application/json
      description: Retrieve details of a specific access review by ID
      parameters:
      - description: Access Review ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Access review retrieved successfully
          schema:
            $ref: '#/definitions/models.AccessReview'
        "400":
          description: Invalid review ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Access review not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get access review
      tags:
      - Access Reviews
    put:
      consumes:
      - application/json
      description: Update an existing access review
      parameters:
      - description: Access Review ID
        in: path
        name: id
        required: true
        type: string
      - description: Updated access review data
        in: body
        name: review
        required: true
        schema:
          $ref: '#/definitions/models.AccessReview'
      produces:
      - application/json
      responses:
        "200":
          description: Access review updated successfully
          schema:
            $ref: '#/definitions/models.AccessReview'
        "400":
          description: Invalid request data
          schema:
            $ref: '#/definitions/ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Access review not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update access review
      tags:
      - Access Reviews
  /access-reviews/{id}/complete:
    post:
      consumes:
      - application/json
      description: Mark an access review as completed with findings and recommendations
      parameters:
      - description: Access Review ID
        in: path
        name: id
        required: true
        type: string
      - description: Completion data
        in: body
        name: completion
        required: true
        schema:
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: Access review completed successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request data
          schema:
            $ref: '#/definitions/ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Access review not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Complete access review
      tags:
      - Access Reviews
  /admin/health-check:
    get:
      consumes:
      - application/json
      description: Perform comprehensive health checks on all system components
      produces:
      - application/json
      responses:
        "200":
          description: Health check completed successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: System health check
      tags:
      - Admin
  /admin/maintenance-mode:
    delete:
      consumes:
      - application/json
      description: Disable system-wide maintenance mode to restore normal access
      produces:
      - application/json
      responses:
        "200":
          description: Maintenance mode disabled successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Disable maintenance mode
      tags:
      - Admin
    post:
      consumes:
      - application/json
      description: Enable system-wide maintenance mode to restrict access
      produces:
      - application/json
      responses:
        "200":
          description: Maintenance mode enabled successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Enable maintenance mode
      tags:
      - Admin
  /admin/settings:
    get:
      description: Retrieve system-wide global settings
      produces:
      - application/json
      responses:
        "200":
          description: Global settings retrieved
          schema:
            $ref: '#/definitions/SuccessResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get global settings
      tags:
      - System Administration
    put:
      consumes:
      - application/json
      description: Update system-wide global settings
      parameters:
      - description: Global settings to update
        in: body
        name: settings
        required: true
        schema:
          $ref: '#/definitions/models.GlobalSettings'
      produces:
      - application/json
      responses:
        "200":
          description: Global settings updated
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request body
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update global settings
      tags:
      - System Administration
  /admin/stats:
    get:
      consumes:
      - application/json
      description: Retrieve comprehensive system statistics for administrators
      produces:
      - application/json
      responses:
        "200":
          description: System statistics retrieved successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get system statistics
      tags:
      - Admin
  /audit/events:
    get:
      consumes:
      - application/json
      description: Retrieve audit trail events with filtering and pagination
      parameters:
      - description: Organization ID
        in: query
        name: organization_id
        type: string
      - description: Principal (User) ID
        in: query
        name: principal_id
        type: string
      - description: Action filter
        in: query
        name: action
        type: string
      - description: Resource type filter
        in: query
        name: resource_type
        type: string
      - description: Result filter (success/failure)
        in: query
        name: result
        type: string
      - description: Severity filter
        in: query
        name: severity
        type: string
      - description: Start time (RFC3339)
        in: query
        name: start_time
        type: string
      - description: End time (RFC3339)
        in: query
        name: end_time
        type: string
      - description: 'Limit (default: 50, max: 100)'
        in: query
        name: limit
        type: integer
      - description: 'Offset (default: 0)'
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Audit events retrieved successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request parameters
          schema:
            $ref: '#/definitions/ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: List audit events
      tags:
      - Audit & Compliance
  /audit/events/{id}:
    get:
      consumes:
      - application/json
      description: Retrieve details of a specific audit event by ID
      parameters:
      - description: Audit Event ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Audit event retrieved successfully
          schema:
            $ref: '#/definitions/models.AuditEvent'
        "400":
          description: Invalid event ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Audit event not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get audit event
      tags:
      - Audit & Compliance
  /audit/reports/access:
    get:
      consumes:
      - application/json
      description: Generate a comprehensive access report with user activity metrics
      parameters:
      - description: Organization ID
        in: query
        name: organization_id
        type: string
      - description: Start time (RFC3339)
        in: query
        name: start_time
        type: string
      - description: End time (RFC3339)
        in: query
        name: end_time
        type: string
      - description: Specific user ID
        in: query
        name: user_id
        type: string
      - description: Include detailed user activity
        in: query
        name: include_details
        type: boolean
      produces:
      - application/json
      responses:
        "200":
          description: Access report generated successfully
          schema:
            $ref: '#/definitions/queries.AccessReportData'
        "400":
          description: Invalid request parameters
          schema:
            $ref: '#/definitions/ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Generate access report
      tags:
      - Audit & Compliance
  /audit/reports/compliance:
    get:
      consumes:
      - application/json
      description: Generate compliance posture report with security metrics and violations
      parameters:
      - description: Organization ID
        in: query
        name: organization_id
        type: string
      - description: Start time (RFC3339)
        in: query
        name: start_time
        type: string
      - description: End time (RFC3339)
        in: query
        name: end_time
        type: string
      - collectionFormat: csv
        description: Compliance standards (SOX, PCI-DSS, GDPR)
        in: query
        items:
          type: string
        name: standards
        type: array
      produces:
      - application/json
      responses:
        "200":
          description: Compliance report generated successfully
          schema:
            $ref: '#/definitions/queries.ComplianceReportData'
        "400":
          description: Invalid request parameters
          schema:
            $ref: '#/definitions/ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Generate compliance report
      tags:
      - Audit & Compliance
  /audit/reports/policy-usage:
    get:
      consumes:
      - application/json
      description: Generate policy usage metrics and effectiveness analysis
      parameters:
      - description: Organization ID
        in: query
        name: organization_id
        type: string
      - description: Start time (RFC3339)
        in: query
        name: start_time
        type: string
      - description: End time (RFC3339)
        in: query
        name: end_time
        type: string
      - description: Specific policy ID
        in: query
        name: policy_id
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Policy usage report generated successfully
          schema:
            $ref: '#/definitions/queries.PolicyUsageReportData'
        "400":
          description: Invalid request parameters
          schema:
            $ref: '#/definitions/ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Generate policy usage report
      tags:
      - Audit & Compliance
  /auth/create-admin:
    post:
      consumes:
      - application/json
      description: Create an admin user with all privileges for initial system setup
      parameters:
      - description: Admin user creation details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handlers.CreateAdminRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Admin user created successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request format or validation error
          schema:
            $ref: '#/definitions/ErrorResponse'
        "409":
          description: User already exists or admin already exists
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      summary: Create admin user
      tags:
      - Authentication
  /auth/forgot-password:
    post:
      consumes:
      - application/json
      description: Send password reset email to user
      parameters:
      - description: Email address
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/ForgotPasswordRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Password reset email sent
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid email format
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: User not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      summary: Forgot password
      tags:
      - Authentication
  /auth/login:
    post:
      consumes:
      - application/json
      description: Authenticate user with email and password
      parameters:
      - description: Login credentials
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handlers.LoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Successfully authenticated
          schema:
            $ref: '#/definitions/handlers.LoginResponse'
        "400":
          description: Invalid request format
          schema:
            $ref: '#/definitions/ErrorResponse'
        "401":
          description: Invalid credentials
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      summary: User login
      tags:
      - Authentication
  /auth/logout:
    post:
      description: Logout user and invalidate session
      produces:
      - application/json
      responses:
        "200":
          description: Successfully logged out
          schema:
            $ref: '#/definitions/SuccessResponse'
        "401":
          description: Unauthorized - invalid or missing token
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: User logout
      tags:
      - Authentication
  /auth/mfa/backup-codes:
    post:
      consumes:
      - application/json
      description: Generate backup codes for multi-factor authentication recovery
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.BackupCodesResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - Bearer: []
      summary: Generate MFA backup codes
      tags:
      - MFA
  /auth/mfa/disable:
    delete:
      consumes:
      - application/json
      description: Disable multi-factor authentication for the authenticated user
      parameters:
      - description: MFA disable details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.DisableMFARequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.MessageResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - Bearer: []
      summary: Disable MFA
      tags:
      - MFA
  /auth/mfa/setup:
    post:
      consumes:
      - application/json
      description: Set up multi-factor authentication for the authenticated user
      parameters:
      - description: MFA setup details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.SetupMFARequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.SetupMFAResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - Bearer: []
      summary: Setup MFA
      tags:
      - MFA
  /auth/mfa/verify:
    post:
      consumes:
      - application/json
      description: Verify multi-factor authentication code for login
      parameters:
      - description: MFA verification details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.VerifyMFARequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.LoginResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/ErrorResponse'
      summary: Verify MFA
      tags:
      - MFA
  /auth/refresh:
    post:
      consumes:
      - application/json
      description: Get new access token using refresh token
      parameters:
      - description: Refresh token
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/RefreshTokenRequest'
      produces:
      - application/json
      responses:
        "200":
          description: New access token generated
          schema:
            $ref: '#/definitions/handlers.LoginResponse'
        "400":
          description: Invalid request format
          schema:
            $ref: '#/definitions/ErrorResponse'
        "401":
          description: Invalid or expired refresh token
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      summary: Refresh access token
      tags:
      - Authentication
  /auth/register:
    post:
      consumes:
      - application/json
      description: Register a new user account
      parameters:
      - description: Registration details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handlers.RegisterRequest'
      produces:
      - application/json
      responses:
        "201":
          description: User registered successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request format or validation error
          schema:
            $ref: '#/definitions/ErrorResponse'
        "409":
          description: User already exists
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      summary: Register new user
      tags:
      - Authentication
  /auth/resend-verification:
    post:
      consumes:
      - application/json
      description: Resend email verification link
      parameters:
      - description: Email address
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/ResendVerificationRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Verification email sent
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid email format
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: User not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      summary: Resend verification email
      tags:
      - Authentication
  /auth/reset-password:
    post:
      consumes:
      - application/json
      description: Reset user password using reset token
      parameters:
      - description: Reset password details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/ResetPasswordRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Password reset successful
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request format
          schema:
            $ref: '#/definitions/ErrorResponse'
        "401":
          description: Invalid or expired reset token
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      summary: Reset password
      tags:
      - Authentication
  /auth/verify-email:
    post:
      consumes:
      - application/json
      description: Verify user email address using verification token
      parameters:
      - description: Verification token
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/VerifyEmailRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Email verified successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request format
          schema:
            $ref: '#/definitions/ErrorResponse'
        "401":
          description: Invalid or expired verification token
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      summary: Verify email
      tags:
      - Authentication
  /authz/bulk-check:
    post:
      consumes:
      - application/json
      description: Check multiple action/resource pairs efficiently
      parameters:
      - description: Bulk permission check request
        in: body
        name: request
        required: true
        schema:
          properties:
            requests:
              items:
                $ref: '#/definitions/queries.PermissionCheckRequest'
              type: array
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: Bulk permission check completed
          schema:
            items:
              $ref: '#/definitions/queries.PermissionCheckResult'
            type: array
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Bulk check permissions
      tags:
      - Authorization
  /authz/check:
    post:
      consumes:
      - application/json
      description: Check if a principal is allowed an action on a resource
      parameters:
      - description: Permission check request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/queries.PermissionCheckRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Permission check completed
          schema:
            $ref: '#/definitions/queries.PermissionCheckResult'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Check permission
      tags:
      - Authorization
  /authz/effective-permissions:
    get:
      consumes:
      - application/json
      description: Retrieve effective permissions for authenticated principal
      parameters:
      - description: Principal ID (if not provided, uses current user)
        in: query
        name: principal_id
        type: string
      - description: Principal type (user, group, role)
        in: query
        name: principal_type
        type: string
      - description: Organization ID
        in: query
        name: organization_id
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Effective permissions retrieved
          schema:
            $ref: '#/definitions/queries.EffectivePermissions'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get effective permissions
      tags:
      - Authorization
  /authz/simulate-access:
    post:
      consumes:
      - application/json
      description: Simulate an access decision for a hypothetical request
      parameters:
      - description: Access simulation request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/queries.PermissionCheckRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Access simulation completed
          schema:
            $ref: '#/definitions/queries.PermissionCheckResult'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Simulate access
      tags:
      - Authorization
  /groups:
    get:
      consumes:
      - application/json
      description: Retrieve groups with pagination and optional organization filtering.
        Returns all active groups with metadata including total count and pagination
        info.
      parameters:
      - description: Number of groups to return (default 50, max 200)
        in: query
        name: limit
        type: integer
      - description: Number of groups to skip (default 0)
        in: query
        name: offset
        type: integer
      - description: Sort by field (name, created_at)
        in: query
        name: sort
        type: string
      - description: Sort order (asc, desc)
        in: query
        name: order
        type: string
      - description: Filter by organization ID (UUID format)
        in: query
        name: organization_id
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Groups retrieved successfully with pagination metadata
          schema:
            allOf:
            - $ref: '#/definitions/SuccessResponse'
            - properties:
                data:
                  properties:
                    has_more:
                      type: boolean
                    items:
                      items:
                        $ref: '#/definitions/models.Group'
                      type: array
                    limit:
                      type: integer
                    offset:
                      type: integer
                    total:
                      type: integer
                  type: object
              type: object
        "400":
          description: Invalid query parameters (invalid limit/offset)
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: List groups
      tags:
      - Group Management
    post:
      consumes:
      - application/json
      description: 'Create a new group within an organization. Group names must be
        unique within the organization. Required fields: name, organization_id. Optional
        fields are set to defaults (group_type="standard", status="active", attributes="{}").'
      parameters:
      - description: 'Group details - Example: {\'
        in: body
        name: request
        required: true
        schema:
          properties:
            description:
              type: string
            group_type:
              type: string
            max_members:
              type: integer
            name:
              type: string
            organization_id:
              type: string
          type: object
      produces:
      - application/json
      responses:
        "201":
          description: Group created successfully with generated ID and timestamps
          schema:
            allOf:
            - $ref: '#/definitions/SuccessResponse'
            - properties:
                data:
                  $ref: '#/definitions/models.Group'
              type: object
        "400":
          description: Invalid request body or missing required fields (name, organization_id)
          schema:
            allOf:
            - $ref: '#/definitions/ErrorResponse'
            - properties:
                error:
                  type: string
                message:
                  type: string
              type: object
        "409":
          description: Conflict - A group with this name already exists in the organization
          schema:
            allOf:
            - $ref: '#/definitions/ErrorResponse'
            - properties:
                error:
                  type: string
                message:
                  type: string
              type: object
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Create group
      tags:
      - Group Management
  /groups/{id}:
    delete:
      consumes:
      - application/json
      description: Soft delete a group by setting the deleted_at timestamp. The group
        remains in the database but is excluded from queries. Returns the group ID
        and deletion timestamp.
      parameters:
      - description: Group ID (UUID format)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Group deleted successfully with deletion timestamp
          schema:
            allOf:
            - $ref: '#/definitions/SuccessResponse'
            - properties:
                data:
                  properties:
                    deleted_at:
                      type: string
                    group_id:
                      type: string
                  type: object
              type: object
        "400":
          description: Invalid group ID (empty or malformed)
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Group not found or already deleted
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Delete group
      tags:
      - Group Management
    get:
      consumes:
      - application/json
      description: Retrieve detailed information about a specific group by its UUID.
        Returns complete group details including all fields and timestamps.
      parameters:
      - description: Group ID (UUID format)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Group retrieved successfully with all details
          schema:
            allOf:
            - $ref: '#/definitions/SuccessResponse'
            - properties:
                data:
                  $ref: '#/definitions/models.Group'
              type: object
        "400":
          description: Invalid group ID (empty or malformed)
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Group not found or has been deleted
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get group
      tags:
      - Group Management
    put:
      consumes:
      - application/json
      description: 'Update a group''s properties with partial update support. Only
        fields provided in the request are updated - missing fields retain their current
        values. Updatable fields: name, description, max_members, status. Immutable
        fields: id, organization_id, group_type. Group names must remain unique within
        the organization.'
      parameters:
      - description: Group ID (UUID format)
        in: path
        name: id
        required: true
        type: string
      - description: 'Updated group details (partial) - Example: {\'
        in: body
        name: request
        required: true
        schema:
          properties:
            description:
              type: string
            max_members:
              type: integer
            name:
              type: string
            status:
              type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: Group updated successfully with refreshed updated_at timestamp
          schema:
            allOf:
            - $ref: '#/definitions/SuccessResponse'
            - properties:
                data:
                  $ref: '#/definitions/models.Group'
              type: object
        "400":
          description: Invalid request body or group ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Group not found or has been deleted
          schema:
            $ref: '#/definitions/ErrorResponse'
        "409":
          description: Conflict - A group with this name already exists in the organization
          schema:
            allOf:
            - $ref: '#/definitions/ErrorResponse'
            - properties:
                error:
                  type: string
                message:
                  type: string
              type: object
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update group
      tags:
      - Group Management
  /groups/{id}/members:
    get:
      consumes:
      - application/json
      description: Retrieve all active members of a group with their membership details
        including principal information, role in group, and join timestamps.
      parameters:
      - description: Group ID (UUID format)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Group members retrieved successfully with count
          schema:
            allOf:
            - $ref: '#/definitions/SuccessResponse'
            - properties:
                data:
                  properties:
                    count:
                      type: integer
                    group_id:
                      type: string
                    members:
                      items:
                        $ref: '#/definitions/models.GroupMembership'
                      type: array
                  type: object
              type: object
        "400":
          description: Invalid group ID (empty or malformed)
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: List group members
      tags:
      - Group Management
    post:
      consumes:
      - application/json
      description: 'Add a principal (user or service account) to a group. Principal
        must exist in the system. Required fields: principal_id (UUID), principal_type
        (user/service_account). Optional: role_in_group (defaults to \"member\"),
        expires_at (RFC3339 format). Membership is automatically timestamped with
        joined_at and tracks who added the member.'
      parameters:
      - description: Group ID (UUID format)
        in: path
        name: id
        required: true
        type: string
      - description: 'Membership details - Example: {\'
        in: body
        name: request
        required: true
        schema:
          properties:
            expires_at:
              type: string
            principal_id:
              type: string
            principal_type:
              type: string
            role_in_group:
              type: string
          type: object
      produces:
      - application/json
      responses:
        "201":
          description: Group member added successfully with generated membership ID
            and timestamps
          schema:
            allOf:
            - $ref: '#/definitions/SuccessResponse'
            - properties:
                data:
                  $ref: '#/definitions/models.GroupMembership'
              type: object
        "400":
          description: Invalid request body, missing required fields, or invalid expires_at
            format
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error or principal not found
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Add group member
      tags:
      - Group Management
  /groups/{id}/members/{user_id}:
    delete:
      consumes:
      - application/json
      description: Remove a principal from a group membership by deleting the membership
        record. Requires both group ID and principal ID. Principal type defaults to
        \"user\" if not specified.
      parameters:
      - description: Group ID (UUID format)
        in: path
        name: id
        required: true
        type: string
      - description: Principal ID (UUID format) - user or service account to remove
        in: path
        name: user_id
        required: true
        type: string
      - description: 'Principal type: ''user'' or ''service_account'' (default: ''user'')'
        in: query
        name: principal_type
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Group member removed successfully with confirmation
          schema:
            allOf:
            - $ref: '#/definitions/SuccessResponse'
            - properties:
                data:
                  properties:
                    group_id:
                      type: string
                    principal_id:
                      type: string
                    removed:
                      type: boolean
                  type: object
              type: object
        "400":
          description: Invalid parameters (missing group ID or principal ID)
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Membership not found (principal is not a member of this group)
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Remove group member
      tags:
      - Group Management
  /groups/{id}/permissions:
    get:
      consumes:
      - application/json
      description: Retrieve aggregated allow/deny permissions derived from member
        role assignments. Returns a comprehensive view of all permissions granted
        to group members through their assigned roles, including both allowed and
        denied permissions with counts in the summary.
      parameters:
      - description: Group ID (UUID format)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Group permissions retrieved successfully with allow/deny lists
            and summary counts (JSON string format)
          schema:
            allOf:
            - $ref: '#/definitions/SuccessResponse'
            - properties:
                data:
                  properties:
                    group_id:
                      type: string
                    permissions:
                      type: string
                  type: object
              type: object
        "400":
          description: Invalid group ID (empty or malformed)
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get group permissions
      tags:
      - Group Management
  /organizations:
    get:
      consumes:
      - application/json
      description: Retrieve paginated list of organizations
      parameters:
      - description: Items per page (1-1000)
        in: query
        name: limit
        type: integer
      - description: Offset for pagination
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Organizations retrieved
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid pagination parameters
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: List organizations
      tags:
      - Organization Management
    post:
      consumes:
      - application/json
      description: Create a new organization (tenant)
      parameters:
      - description: Organization details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.Organization'
      produces:
      - application/json
      responses:
        "201":
          description: Organization created
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Validation error
          schema:
            $ref: '#/definitions/ErrorResponse'
        "409":
          description: Organization already exists
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Create organization
      tags:
      - Organization Management
  /organizations/{id}:
    delete:
      description: Soft delete an organization
      parameters:
      - description: Organization ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Organization deleted
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid organization ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Organization not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Delete organization
      tags:
      - Organization Management
    get:
      description: Retrieve an organization by ID
      parameters:
      - description: Organization ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Organization retrieved
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid organization ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Organization not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get organization
      tags:
      - Organization Management
    put:
      consumes:
      - application/json
      description: Update organization attributes
      parameters:
      - description: Organization ID
        in: path
        name: id
        required: true
        type: string
      - description: Updated organization
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.Organization'
      produces:
      - application/json
      responses:
        "200":
          description: Organization updated
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Organization not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update organization
      tags:
      - Organization Management
  /organizations/{id}/groups:
    get:
      description: List all groups belonging to an organization
      parameters:
      - description: Organization ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Groups retrieved
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid organization ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: List organization groups
      tags:
      - Organization Management
  /organizations/{id}/policies:
    get:
      description: List all policies within an organization
      parameters:
      - description: Organization ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Policies retrieved
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid organization ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: List organization policies
      tags:
      - Organization Management
  /organizations/{id}/resources:
    get:
      description: List all resources owned by an organization
      parameters:
      - description: Organization ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Resources retrieved
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid organization ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: List organization resources
      tags:
      - Organization Management
  /organizations/{id}/roles:
    get:
      description: List all roles defined in an organization
      parameters:
      - description: Organization ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Roles retrieved
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid organization ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: List organization roles
      tags:
      - Organization Management
  /organizations/{id}/settings:
    get:
      description: Retrieve settings JSON for an organization
      parameters:
      - description: Organization ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Settings retrieved
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid organization ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Organization not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get organization settings
      tags:
      - Organization Management
    put:
      consumes:
      - application/json
      description: Update settings JSON for an organization
      parameters:
      - description: Organization ID
        in: path
        name: id
        required: true
        type: string
      - description: Updated settings payload
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handlers.updateSettingsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Settings updated
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Organization not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update organization settings
      tags:
      - Organization Management
  /organizations/{id}/users:
    get:
      description: List all users belonging to an organization
      parameters:
      - description: Organization ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Users retrieved
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid organization ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: List organization users
      tags:
      - Organization Management
  /policies:
    get:
      consumes:
      - application/json
      description: Retrieve all policies with pagination and filtering
      parameters:
      - description: 'Number of policies per page (default: 50)'
        in: query
        name: limit
        type: integer
      - description: 'Number of policies to skip (default: 0)'
        in: query
        name: offset
        type: integer
      - description: Field to sort by (created_at, name, status)
        in: query
        name: sort_by
        type: string
      - description: Sort order (asc, desc)
        in: query
        name: order
        type: string
      - description: Filter by organization ID
        in: query
        name: organization_id
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Policies listed successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request parameters
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: List policies
      tags:
      - Policy Management
    post:
      consumes:
      - application/json
      description: Create a new policy with document validation
      parameters:
      - description: Policy definition
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.Policy'
      produces:
      - application/json
      responses:
        "201":
          description: Policy created successfully
          schema:
            $ref: '#/definitions/models.Policy'
        "400":
          description: Invalid request or policy document
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Create policy
      tags:
      - Policy Management
  /policies/{id}:
    delete:
      consumes:
      - application/json
      description: Soft delete a policy (mark as deleted, change status)
      parameters:
      - description: Policy ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Policy deleted successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid policy ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Policy not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Delete policy
      tags:
      - Policy Management
    get:
      consumes:
      - application/json
      description: Retrieve a specific policy by ID
      parameters:
      - description: Policy ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Policy retrieved successfully
          schema:
            $ref: '#/definitions/models.Policy'
        "400":
          description: Invalid policy ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Policy not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get policy
      tags:
      - Policy Management
    put:
      consumes:
      - application/json
      description: Update an existing policy and create new version if document changed
      parameters:
      - description: Policy ID
        in: path
        name: id
        required: true
        type: string
      - description: Updated policy
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.Policy'
      produces:
      - application/json
      responses:
        "200":
          description: Policy updated successfully
          schema:
            $ref: '#/definitions/models.Policy'
        "400":
          description: Invalid request or policy document
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Policy not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update policy
      tags:
      - Policy Management
  /policies/{id}/approve:
    post:
      consumes:
      - application/json
      description: Approve a pending policy version for activation
      parameters:
      - description: Policy ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Policy approved successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid policy ID or policy not in draft status
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Policy not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Approve policy
      tags:
      - Policy Management
  /policies/{id}/rollback:
    post:
      consumes:
      - application/json
      description: Rollback policy to a specified version
      parameters:
      - description: Policy ID
        in: path
        name: id
        required: true
        type: string
      - description: Version to rollback to
        in: body
        name: request
        required: true
        schema:
          properties:
            version:
              type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: Policy rolled back successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request or version
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Policy or version not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Rollback policy
      tags:
      - Policy Management
  /policies/{id}/versions:
    get:
      consumes:
      - application/json
      description: Retrieve all versions of a policy with history
      parameters:
      - description: Policy ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Policy versions retrieved
          schema:
            items:
              $ref: '#/definitions/queries.PolicyVersion'
            type: array
        "400":
          description: Invalid policy ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Policy not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: List policy versions
      tags:
      - Policy Management
  /policies/simulate:
    post:
      consumes:
      - application/json
      description: Simulate the effect of a policy against hypothetical requests
      parameters:
      - description: Simulation input
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/queries.PolicySimulationRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Policy simulation completed
          schema:
            $ref: '#/definitions/queries.PolicySimulationResult'
        "400":
          description: Invalid simulation request
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Simulate policy
      tags:
      - Policy Management
  /resources:
    get:
      consumes:
      - application/json
      description: Retrieve all resources with pagination support
      parameters:
      - description: Filter by organization ID
        in: query
        name: organization_id
        type: string
      - description: Filter by resource type
        in: query
        name: type
        type: string
      - description: Number of resources to return (default 20)
        in: query
        name: limit
        type: integer
      - description: Number of resources to skip (default 0)
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Resources listed successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: List resources
      tags:
      - Resource Management
    post:
      consumes:
      - application/json
      description: Create a new managed resource
      parameters:
      - description: Resource details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.Resource'
      produces:
      - application/json
      responses:
        "201":
          description: Resource created successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request body or validation errors
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Create resource
      tags:
      - Resource Management
  /resources/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a resource
      parameters:
      - description: Resource ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Resource deleted successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid resource ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Resource not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Delete resource
      tags:
      - Resource Management
    get:
      consumes:
      - application/json
      description: Retrieve details of a specific resource
      parameters:
      - description: Resource ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Resource retrieved successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid resource ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Resource not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get resource
      tags:
      - Resource Management
    put:
      consumes:
      - application/json
      description: Update properties of a resource
      parameters:
      - description: Resource ID
        in: path
        name: id
        required: true
        type: string
      - description: Updated resource details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.Resource'
      produces:
      - application/json
      responses:
        "200":
          description: Resource updated successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request body or resource ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Resource not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update resource
      tags:
      - Resource Management
  /resources/{id}/access-log:
    get:
      consumes:
      - application/json
      description: Retrieve access events for a resource
      parameters:
      - description: Resource ID
        in: path
        name: id
        required: true
        type: string
      - description: Number of log entries to return (default 50)
        in: query
        name: limit
        type: integer
      - description: Number of log entries to skip (default 0)
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Access log retrieved successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid resource ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Resource not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get resource access log
      tags:
      - Resource Management
  /resources/{id}/permissions:
    get:
      consumes:
      - application/json
      description: Retrieve permissions for a resource
      parameters:
      - description: Resource ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Resource permissions retrieved successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid resource ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Resource not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get resource permissions
      tags:
      - Resource Management
    post:
      consumes:
      - application/json
      description: Apply permissions to a resource
      parameters:
      - description: Resource ID
        in: path
        name: id
        required: true
        type: string
      - description: Permissions definition
        in: body
        name: request
        required: true
        schema:
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: Permissions set successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request body or resource ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Resource not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Set resource permissions
      tags:
      - Resource Management
  /resources/{id}/share:
    delete:
      consumes:
      - application/json
      description: Remove sharing permissions
      parameters:
      - description: Resource ID
        in: path
        name: id
        required: true
        type: string
      - description: Unshare details
        in: body
        name: request
        required: true
        schema:
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: Resource unshared successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request body or resource ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Resource not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Unshare resource
      tags:
      - Resource Management
    post:
      consumes:
      - application/json
      description: Share a resource with a user or group
      parameters:
      - description: Resource ID
        in: path
        name: id
        required: true
        type: string
      - description: Share details
        in: body
        name: request
        required: true
        schema:
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: Resource shared successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request body or resource ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Resource not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Share resource
      tags:
      - Resource Management
  /roles:
    get:
      consumes:
      - application/json
      description: Retrieve all roles with pagination, sorting, and filtering options
      parameters:
      - description: 'Number of roles to return (default: 50)'
        in: query
        name: limit
        type: integer
      - description: 'Number of roles to skip (default: 0)'
        in: query
        name: offset
        type: integer
      - description: Sort by field (name, created_at, updated_at, role_type)
        in: query
        name: sort
        type: string
      - description: Sort order (asc, desc)
        in: query
        name: order
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Roles retrieved successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid query parameters
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: List roles
      tags:
      - Role Management
    post:
      consumes:
      - application/json
      description: Create a new role with policies and permissions
      parameters:
      - description: Role details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.Role'
      produces:
      - application/json
      responses:
        "201":
          description: Role created successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request format or validation errors
          schema:
            $ref: '#/definitions/ErrorResponse'
        "409":
          description: Role already exists
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Create role
      tags:
      - Role Management
  /roles/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a role and remove all associated assignments
      parameters:
      - description: Role ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Role deleted successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid role ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Role not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Delete role
      tags:
      - Role Management
    get:
      consumes:
      - application/json
      description: Retrieve detailed information about a specific role
      parameters:
      - description: Role ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Role retrieved successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid role ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Role not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get role
      tags:
      - Role Management
    put:
      consumes:
      - application/json
      description: Update an existing role's properties and metadata
      parameters:
      - description: Role ID
        in: path
        name: id
        required: true
        type: string
      - description: Updated role details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.Role'
      produces:
      - application/json
      responses:
        "200":
          description: Role updated successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request format or validation errors
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Role not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update role
      tags:
      - Role Management
  /service-accounts:
    get:
      consumes:
      - application/json
      description: Retrieve a paginated list of service accounts with filtering and
        sorting options
      parameters:
      - description: 'Page number (default: 1)'
        in: query
        name: page
        type: integer
      - description: 'Items per page (default: 10, max: 100)'
        in: query
        name: limit
        type: integer
      - description: 'Sort field (default: created_at)'
        in: query
        name: sort
        type: string
      - description: 'Sort order: asc or desc (default: desc)'
        in: query
        name: order
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Successfully retrieved service accounts list
          schema:
            $ref: '#/definitions/SuccessResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: List service accounts
      tags:
      - Service Accounts
    post:
      consumes:
      - application/json
      description: Create a new service account with specified details
      parameters:
      - description: Service account data
        in: body
        name: serviceAccount
        required: true
        schema:
          $ref: '#/definitions/models.ServiceAccount'
      produces:
      - application/json
      responses:
        "201":
          description: Service account created successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid input data
          schema:
            $ref: '#/definitions/ErrorResponse'
        "409":
          description: Service account already exists
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Create service account
      tags:
      - Service Accounts
  /service-accounts/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a service account and revoke all its API keys
      parameters:
      - description: Service account ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Service account deleted successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "404":
          description: Service account not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Delete service account
      tags:
      - Service Accounts
    get:
      consumes:
      - application/json
      description: Retrieve a specific service account by its ID
      parameters:
      - description: Service account ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Service account retrieved successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "404":
          description: Service account not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get service account
      tags:
      - Service Accounts
    put:
      consumes:
      - application/json
      description: Update an existing service account with new information
      parameters:
      - description: Service account ID
        in: path
        name: id
        required: true
        type: string
      - description: Updated service account data
        in: body
        name: serviceAccount
        required: true
        schema:
          $ref: '#/definitions/models.ServiceAccount'
      produces:
      - application/json
      responses:
        "200":
          description: Service account updated successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid input data
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Service account not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update service account
      tags:
      - Service Accounts
  /service-accounts/{id}/keys:
    get:
      consumes:
      - application/json
      description: Retrieve all API keys for the specified service account
      parameters:
      - description: Service account ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: API keys retrieved successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "404":
          description: Service account not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: List API keys
      tags:
      - Service Accounts
    post:
      consumes:
      - application/json
      description: Generate a new API key for the specified service account
      parameters:
      - description: Service account ID
        in: path
        name: id
        required: true
        type: string
      - description: API key configuration
        in: body
        name: apiKey
        required: true
        schema:
          $ref: '#/definitions/models.APIKey'
      produces:
      - application/json
      responses:
        "201":
          description: API key generated successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid input data
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Service account not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Generate API key
      tags:
      - Service Accounts
  /service-accounts/{id}/keys/{key_id}:
    delete:
      consumes:
      - application/json
      description: Revoke a specific API key for the service account
      parameters:
      - description: Service account ID
        in: path
        name: id
        required: true
        type: string
      - description: API key ID
        in: path
        name: key_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: API key revoked successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "404":
          description: API key not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Revoke API key
      tags:
      - Service Accounts
  /service-accounts/{id}/rotate-keys:
    post:
      consumes:
      - application/json
      description: Rotate all API keys for the specified service account
      parameters:
      - description: Service account ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Keys rotated successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "404":
          description: Service account not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Rotate service account keys
      tags:
      - Service Accounts
  /sessions:
    get:
      consumes:
      - application/json
      description: Retrieve sessions associated with the current principal
      parameters:
      - description: 'Number of sessions per page (default: 50)'
        in: query
        name: limit
        type: integer
      - description: 'Number of sessions to skip (default: 0)'
        in: query
        name: offset
        type: integer
      - description: Field to sort by (last_used_at, issued_at, expires_at)
        in: query
        name: sort_by
        type: string
      - description: Sort order (asc, desc)
        in: query
        name: order
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Sessions listed successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request parameters
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: List sessions
      tags:
      - Session Management
  /sessions/{id}:
    delete:
      consumes:
      - application/json
      description: Invalidate a specific session (admin only)
      parameters:
      - description: Session ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Session revoked successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid session ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "403":
          description: Access denied
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Session not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Revoke session
      tags:
      - Session Management
    get:
      consumes:
      - application/json
      description: Retrieve a specific session by ID
      parameters:
      - description: Session ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Session retrieved successfully
          schema:
            $ref: '#/definitions/models.Session'
        "400":
          description: Invalid session ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "403":
          description: Access denied
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Session not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get session
      tags:
      - Session Management
  /sessions/{id}/extend:
    post:
      consumes:
      - application/json
      description: Extend the expiration of a session
      parameters:
      - description: Session ID
        in: path
        name: id
        required: true
        type: string
      - description: Extension duration (e.g., '2h', '30m')
        in: body
        name: request
        schema:
          properties:
            duration:
              type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: Session extended successfully
          schema:
            $ref: '#/definitions/models.Session'
        "400":
          description: Invalid request or session ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "403":
          description: Access denied
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: Session not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Extend session
      tags:
      - Session Management
  /sessions/current:
    delete:
      consumes:
      - application/json
      description: Invalidate the current session (logout)
      produces:
      - application/json
      responses:
        "200":
          description: Current session revoked successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "401":
          description: No active session
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Revoke current session
      tags:
      - Session Management
    get:
      consumes:
      - application/json
      description: Retrieve details of the current session from JWT token
      produces:
      - application/json
      responses:
        "200":
          description: Current session retrieved successfully
          schema:
            $ref: '#/definitions/models.Session'
        "401":
          description: No active session
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get current session
      tags:
      - Session Management
  /users:
    get:
      consumes:
      - application/json
      description: Retrieve a paginated list of users with filtering and sorting options
      parameters:
      - description: 'Page number (default: 1)'
        in: query
        name: page
        type: integer
      - description: 'Items per page (default: 10, max: 100)'
        in: query
        name: limit
        type: integer
      - description: 'Sort field (default: created_at)'
        in: query
        name: sort
        type: string
      - description: 'Sort order: asc or desc (default: desc)'
        in: query
        name: order
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Successfully retrieved users list
          schema:
            $ref: '#/definitions/SuccessResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: List users
      tags:
      - User Management
    post:
      consumes:
      - application/json
      description: Create a new user account with the provided details
      parameters:
      - description: User creation details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/SuccessResponse'
      produces:
      - application/json
      responses:
        "201":
          description: User created successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request format
          schema:
            $ref: '#/definitions/ErrorResponse'
        "409":
          description: User already exists
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Create user
      tags:
      - User Management
  /users/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a user account by ID
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: User deleted successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid user ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: User not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Delete user
      tags:
      - User Management
    get:
      consumes:
      - application/json
      description: Retrieve a specific user's details by their ID
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Successfully retrieved user
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid user ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: User not found
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get user by ID
      tags:
      - User Management
    put:
      consumes:
      - application/json
      description: Update a user's profile information
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: string
      - description: User update details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/SuccessResponse'
      produces:
      - application/json
      responses:
        "200":
          description: User updated successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request format or user ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: User not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update user
      tags:
      - User Management
  /users/{id}/activate:
    post:
      consumes:
      - application/json
      description: Activate a previously suspended user account
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: User activated successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid user ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Activate user
      tags:
      - User Management
  /users/{id}/profile:
    get:
      consumes:
      - application/json
      description: Retrieve detailed profile information for a user
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Successfully retrieved user profile
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid user ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: User profile not found
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get user profile
      tags:
      - User Management
    put:
      consumes:
      - application/json
      description: Update specific profile fields for a user
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: string
      - description: Profile update details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/SuccessResponse'
      produces:
      - application/json
      responses:
        "200":
          description: Profile updated successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request format or user ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "404":
          description: User not found
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update user profile
      tags:
      - User Management
  /users/{id}/sessions:
    delete:
      consumes:
      - application/json
      description: Revoke all active sessions for a specific user
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: User sessions revoked successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid user ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Revoke user sessions
      tags:
      - User Management
    get:
      consumes:
      - application/json
      description: Retrieve all active sessions for a specific user
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Successfully retrieved user sessions
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid user ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get user sessions
      tags:
      - User Management
  /users/{id}/suspend:
    post:
      consumes:
      - application/json
      description: Suspend a user account with a reason
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: string
      - description: Suspension details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/SuccessResponse'
      produces:
      - application/json
      responses:
        "200":
          description: User suspended successfully
          schema:
            $ref: '#/definitions/SuccessResponse'
        "400":
          description: Invalid request format or user ID
          schema:
            $ref: '#/definitions/ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/ErrorResponse'
      security:
      - BearerAuth: []
      summary: Suspend user
      tags:
      - User Management
securityDefinitions:
  BearerAuth:
    description: Type "Bearer" followed by a space and JWT token.
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
